{% extends 'base.html' %}

{% block title %}Choose Access Method - Smart Hotel{% endblock %}

{% block head %}
<style>
.access-page {
    max-width: 700px;
    margin: 0 auto;
}
.access-header {
    text-align: center;
    margin-bottom: 2.5rem;
    animation: fadeInUp 0.5s ease-out;
}
.access-header h1 {
    font-size: 2.25rem;
    margin-bottom: 0.75rem;
    font-weight: 700;
}
.access-header .lead {
    color: var(--text-muted);
    font-size: 1.1rem;
}
.access-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1.5rem;
}
.access-grid > form:nth-child(1) { animation: fadeInUp 0.5s ease-out 0.1s forwards; opacity: 0; }
.access-grid > form:nth-child(2) { animation: fadeInUp 0.5s ease-out 0.2s forwards; opacity: 0; }
@media (max-width: 500px) {
    .access-grid {
        grid-template-columns: 1fr;
    }
}
.access-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    padding: 2.5rem 1.5rem;
    background: var(--card-bg);
    border: 2px solid var(--border);
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow);
    cursor: pointer;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    font-family: inherit;
    width: 100%;
    min-height: 220px;
    position: relative;
    -webkit-appearance: none;
    appearance: none;
    overflow: hidden;
}
.access-btn::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at center, rgba(14,165,233,0.12) 0%, transparent 70%);
    opacity: 0;
    transition: opacity 0.4s ease;
}
.access-btn:hover::before {
    opacity: 1;
}
.access-btn:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: var(--shadow-xl), 0 0 40px rgba(14,165,233,0.15);
    border-color: var(--accent);
}
.access-btn:active {
    transform: translateY(-2px) scale(0.98);
    transition-duration: 0.1s;
}
.access-btn[aria-pressed="true"] {
    border-color: var(--accent);
    background: linear-gradient(180deg, rgba(201, 169, 98, 0.08) 0%, transparent 100%);
    box-shadow: 0 0 0 4px rgba(14,165,233,0.15), 0 12px 32px rgba(14,165,233,0.15);
}
.access-btn .icon-container {
    width: 80px;
    height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--bg);
    border-radius: 50%;
    transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    color: var(--brand);
}
.access-btn:hover .icon-container {
    background: rgba(201, 169, 98, 0.15);
    color: var(--accent-dark);
    transform: scale(1.1) rotate(-5deg);
    box-shadow: 0 8px 24px rgba(14,165,233,0.2);
}
.access-btn[aria-pressed="true"] .icon-container {
    background: var(--accent);
    color: white;
    transform: scale(1.1);
}
.access-btn .title {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text);
}
.access-btn[aria-pressed="true"] .title {
    color: var(--accent-dark);
}
.access-btn .desc {
    font-size: 0.875rem;
    color: var(--text-muted);
}
.access-btn .badge {
    position: absolute;
    top: 12px;
    right: 12px;
    padding: 0.35rem 0.75rem;
    background: var(--accent);
    color: var(--brand);
    font-size: 0.75rem;
    font-weight: 600;
    border-radius: 1rem;
    opacity: 0;
    transform: scale(0.8);
    transition: all 0.25s ease;
    display: flex;
    align-items: center;
    gap: 4px;
}
.access-btn[aria-pressed="true"] .badge {
    opacity: 1;
    transform: scale(1);
}
</style>
{% endblock %}

{% block content %}
<div class="access-page">
    <div class="card p-4 p-md-5">
        <div class="access-header">
            <h1 data-i18n="choose_access_title" data-i18n-res="{{ reservation.reservation_number }}">Choose Access Method</h1>
            <p class="lead">How would you like to access your room?</p>
        </div>
        <form method="post" id="accessForm">
        {% csrf_token %}
        {% if error %}
            <div class="alert alert-danger">{{ error }}</div>
        {% endif %}
        
        <div class="access-grid mb-4">
            <button type="button" class="access-btn" aria-pressed="false" onclick="toggleAccess(this, 'keycard')">
                <input type="hidden" name="access_keycard" id="keycard" value="">
                <span class="badge"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/></svg> Selected</span>
                <div class="icon-container">
                    <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor" viewBox="0 0 16 16"><path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v1h14V4a1 1 0 0 0-1-1H2zm13 4H1v5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V7z"/><path d="M2 10a1 1 0 0 1 1-1h1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1v-1z"/></svg>
                </div>
                <span class="title" data-i18n="keycard">Keycard</span>
                <span class="desc">Traditional room key</span>
            </button>
            <button type="button" class="access-btn" aria-pressed="false" onclick="toggleAccess(this, 'face')">
                <input type="hidden" name="access_face" id="face" value="">
                <span class="badge"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" viewBox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"/></svg> Selected</span>
                <div class="icon-container">
                    <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" fill="currentColor" viewBox="0 0 16 16"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4zm-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10c-2.29 0-3.516.68-4.168 1.332-.678.678-.83 1.418-.832 1.664h10z"/></svg>
                </div>
                <span class="title" data-i18n="face">Face ID</span>
                <span class="desc">Contactless entry</span>
            </button>
        </div>

        <button type="submit" class="btn btn-primary btn-lg w-100">
            <span data-i18n="confirm_access">Confirm Access Method</span>
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="currentColor" viewBox="0 0 16 16" style="margin-left: 8px;"><path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/></svg>
        </button>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function toggleAccess(btn, inputId) {
    var isPressed = btn.getAttribute('aria-pressed') === 'true';
    var newState = !isPressed;
    
    btn.setAttribute('aria-pressed', String(newState));
    document.getElementById(inputId).value = newState ? '1' : '';
}

document.getElementById('accessForm').onsubmit = function(e) {
    var keycard = document.getElementById('keycard').value;
    var face = document.getElementById('face').value;
    if (!keycard && !face) {
        e.preventDefault();
        alert('Please choose at least one access method.');
    }
};
</script>
{% endblock %}
